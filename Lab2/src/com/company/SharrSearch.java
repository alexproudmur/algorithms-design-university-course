package com.company;

public class SharrSearch {
    private static int counterDelta = 0;
    public static void main(String[] args) {
        int[] array = {2, 5, 8, 9, 12, 16, 19, 20, 23, 25, 27, 35};
        //int[] array = {49, 50, 51, 52, 53, 54, 55, 56, 57, 1567, 1568, 1569, 1570, 1571, 1572, 1573, 1574, 1575, 1576, 1598, 1599, 1600, 1601, 1602, 1603, 1604, 1605, 1606, 1607, 1629, 1630, 1631, 1632, 1633, 1634, 1635, 1636, 1637, 1638, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1668, 1669, 1691, 1692, 1693, 1694, 1695, 1696, 1697, 1698, 1699, 1700, 1722, 1723, 1724, 1725, 1726, 1727, 1728, 1729, 1730, 1731, 1753, 1754, 1755, 1756, 1757, 1758, 1759, 1760, 1761, 1762, 1784, 1785, 1786, 1787, 1788, 1789, 1790, 1791, 1792, 1793, 1815, 1816, 1817, 1818, 1819, 1820, 1821, 1822, 1823, 1824, 48625, 48626, 48627, 48628, 48629, 48630, 48631, 48632, 48633, 48634, 48656, 48657, 48658, 48659, 48660, 48661, 48662, 48663, 48664, 48665, 48687, 48688, 48689, 48690, 48691, 48692, 48693, 48694, 48695, 48696, 48718, 48719, 48720, 48721, 48722, 48723, 48724, 48725, 48726, 48727, 48749, 48750, 48751, 48752, 48753, 48754, 48755, 48756, 48757, 48758, 48780, 48781, 48782, 48783, 48784, 48785, 48786, 48787, 48788, 48789, 48811, 48812, 48813, 48814, 48815, 48816, 48817, 48818, 48819, 48820, 48842, 48843, 48844, 48845, 48846, 48847, 48848, 48849, 48850, 48851, 48873, 48874, 48875, 48876, 48877, 48878, 48879, 48880, 48881, 48882, 48904, 48905, 48906, 48907, 48908, 48909, 48910, 48911, 48912, 48913, 49586, 49587, 49588, 49589, 49590, 49591, 49592, 49593, 49594, 49595, 49617, 49618, 49619, 49620, 49621, 49622, 49623, 49624, 49625, 49626, 49648, 49649, 49650, 49651, 49652, 49653, 49654, 49655, 49656, 49657, 49679, 49680, 49681, 49682, 49683, 49684, 49685, 49686, 49687, 49688, 49710, 49711, 49712, 49713, 49714, 49715, 49716, 49717, 49718, 49719, 49741, 49742, 49743, 49744, 49745, 49746, 49747, 49748, 49749, 49750, 49772, 49773, 49774, 49775, 49776, 49777, 49778, 49779, 49780, 49781, 49803, 49804, 49805, 49806, 49807, 49808, 49809, 49810, 49811, 49812, 49834, 49835, 49836, 49837, 49838, 49839, 49840, 49841, 49842, 49843, 49865, 49866, 49867, 49868, 49869, 49870, 49871, 49872, 49873, 49874, 50547, 50548, 50549, 50550, 50551, 50552, 50553, 50554, 50555, 50556, 50578, 50579, 50580, 50581, 50582, 50583, 50584, 50585, 50586, 50587, 50609, 50610, 50611, 50612, 50613, 50614, 50615, 50616, 50617, 50618, 50640, 50641, 50642, 50643, 50644, 50645, 50646, 50647, 50648, 50649, 50671, 50672, 50673, 50674, 50675, 50676, 50677, 50678, 50679, 50680, 50702, 50703, 50704, 50705, 50706, 50707, 50708, 50709, 50710, 50711, 50733, 50734, 50735, 50736, 50737, 50738, 50739, 50740, 50741, 50742, 50764, 50765, 50766, 50767, 50768, 50769, 50770, 50771, 50772, 50773, 50795, 50796, 50797, 50798, 50799, 50800, 50801, 50802, 50803, 50804, 50826, 50827, 50828, 50829, 50830, 50831, 50832, 50833, 50834, 50835, 51508, 51509, 51510, 51511, 51512, 51513, 51514, 51515, 51516, 51517, 51539, 51540, 51541, 51542, 51543, 51544, 51545, 51546, 51547, 51548, 51570, 51571, 51572, 51573, 51574, 51575, 51576, 51577, 51578, 51579, 51601, 51602, 51603, 51604, 51605, 51606, 51607, 51608, 51609, 51610, 51632, 51633, 51634, 51635, 51636, 51637, 51638, 51639, 51640, 51641, 51663, 51664, 51665, 51666, 51667, 51668, 51669, 51670, 51671, 51672, 51694, 51695, 51696, 51697, 51698, 51699, 51700, 51701, 51702, 51703, 51725, 51726, 51727, 51728, 51729, 51730, 51731, 51732, 51733, 51734, 51756, 51757, 51758, 51759, 51760, 51761, 51762, 51763, 51764, 51765, 51787, 51788, 51789, 51790, 51791, 51792, 51793, 51794, 51795, 51796, 52469, 52470, 52471, 52472, 52473, 52474, 52475, 52476, 52477, 52478, 52500, 52501, 52502, 52503, 52504, 52505, 52506, 52507, 52508, 52509, 52531, 52532, 52533, 52534, 52535, 52536, 52537, 52538, 52539, 52540, 52562, 52563, 52564, 52565, 52566, 52567, 52568, 52569, 52570, 52571, 52593, 52594, 52595, 52596, 52597, 52598, 52599, 52600, 52601, 52602, 52624, 52625, 52626, 52627, 52628, 52629, 52630, 52631, 52632, 52633, 52655, 52656, 52657, 52658, 52659, 52660, 52661, 52662, 52663, 52664, 52686, 52687, 52688, 52689, 52690, 52691, 52692, 52693, 52694, 52695, 52717, 52718, 52719, 52720, 52721, 52722, 52723, 52724, 52725, 52726, 52748, 52749, 52750, 52751, 52752, 52753, 52754, 52755, 52756, 52757, 53430, 53431, 53432, 53433, 53434, 53435, 53436, 53437, 53438, 53439, 53461, 53462, 53463, 53464, 53465, 53466, 53467, 53468, 53469, 53470, 53492, 53493, 53494, 53495, 53496, 53497, 53498, 53499, 53500, 53501, 53523, 53524, 53525, 53526, 53527, 53528, 53529, 53530, 53531, 53532, 53554, 53555, 53556, 53557, 53558, 53559, 53560, 53561, 53562, 53563, 53585, 53586, 53587, 53588, 53589, 53590, 53591, 53592, 53593, 53594, 53616, 53617, 53618, 53619, 53620, 53621, 53622, 53623, 53624, 53625, 53647, 53648, 53649, 53650, 53651, 53652, 53653, 53654, 53655, 53656, 53678, 53679, 53680, 53681, 53682, 53683, 53684, 53685, 53686, 53687, 53709, 53710, 53711, 53712, 53713, 53714, 53715, 53716, 53717, 53718, 54391, 54392, 54393, 54394, 54395, 54396, 54397, 54398, 54399, 54400, 54422, 54423, 54424, 54425, 54426, 54427, 54428, 54429, 54430, 54431, 54453, 54454, 54455, 54456, 54457, 54458, 54459, 54460, 54461, 54462, 54484, 54485, 54486, 54487, 54488, 54489, 54490, 54491, 54492, 54493, 54515, 54516, 54517, 54518, 54519, 54520, 54521, 54522, 54523, 54524, 54546, 54547, 54548, 54549, 54550, 54551, 54552, 54553, 54554, 54555, 54577, 54578, 54579, 54580, 54581, 54582, 54583, 54584, 54585, 54586, 54608, 54609, 54610, 54611, 54612, 54613, 54614, 54615, 54616, 54617, 54639, 54640, 54641, 54642, 54643, 54644, 54645, 54646, 54647, 54648, 54670, 54671, 54672, 54673, 54674, 54675, 54676, 54677, 54678, 54679, 55352, 55353, 55354, 55355, 55356, 55357, 55358, 55359, 55360, 55361, 55383, 55384, 55385, 55386, 55387, 55388, 55389, 55390, 55391, 55392, 55414, 55415, 55416, 55417, 55418, 55419, 55420, 55421, 55422, 55423, 55445, 55446, 55447, 55448, 55449, 55450, 55451, 55452, 55453, 55454, 55476, 55477, 55478, 55479, 55480, 55481, 55482, 55483, 55484, 55485, 55507, 55508, 55509, 55510, 55511, 55512, 55513, 55514, 55515, 55516, 55538, 55539, 55540, 55541, 55542, 55543, 55544, 55545, 55546, 55547, 55569, 55570, 55571, 55572, 55573, 55574, 55575, 55576, 55577, 55578, 55600, 55601, 55602, 55603, 55604, 55605, 55606, 55607, 55608, 55609, 55631, 55632, 55633, 55634, 55635, 55636, 55637, 55638, 55639, 55640, 56313, 56314, 56315, 56316, 56317, 56318, 56319, 56320, 56321, 56322, 56344, 56345, 56346, 56347, 56348, 56349, 56350, 56351, 56352, 56353, 56375, 56376, 56377, 56378, 56379, 56380, 56381, 56382, 56383, 56384, 56406, 56407, 56408, 56409, 56410, 56411, 56412, 56413, 56414, 56415, 56437, 56438, 56439, 56440, 56441, 56442, 56443, 56444, 56445, 56446, 56468, 56469, 56470, 56471, 56472, 56473, 56474, 56475, 56476, 56477, 56499, 56500, 56501, 56502, 56503, 56504, 56505, 56506, 56507, 56508, 56530, 56531, 56532, 56533, 56534, 56535, 56536, 56537, 56538, 56539, 56561, 56562, 56563, 56564, 56565, 56566, 56567, 56568, 56569, 56570, 56592, 56593, 56594, 56595, 56596, 56597, 56598, 56599, 56600, 56601, 1507423, 1507424, 1507425, 1507426, 1507427, 1507428, 1507429, 1507430, 1507431, 1507432, 1507454, 1507455, 1507456, 1507457, 1507458, 1507459, 1507460, 1507461, 1507462, 1507463, 1507485, 1507486, 1507487, 1507488, 1507489, 1507490, 1507491, 1507492, 1507493, 1507494, 1507516, 1507517, 1507518, 1507519, 1507520, 1507521, 1507522, 1507523, 1507524, 1507525, 1507547, 1507548, 1507549, 1507550, 1507551, 1507552, 1507553, 1507554, 1507555, 1507556, 1507578, 1507579, 1507580, 1507581, 1507582, 1507583, 1507584, 1507585, 1507586, 1507587, 1507609, 1507610, 1507611, 1507612, 1507613, 1507614, 1507615, 1507616, 1507617, 1507618, 1507640, 1507641, 1507642, 1507643, 1507644, 1507645, 1507646, 1507647, 1507648, 1507649, 1507671, 1507672, 1507673, 1507674, 1507675, 1507676, 1507677, 1507678, 1507679, 1507680, 1507702, 1507703, 1507704, 1507705, 1507706, 1507707, 1507708, 1507709, 1507710, 1507711, 1508384, 1508385, 1508386, 1508387, 1508388, 1508389, 1508390, 1508391, 1508392, 1508393, 1508415, 1508416, 1508417, 1508418, 1508419, 1508420, 1508421, 1508422, 1508423, 1508424, 1508446, 1508447, 1508448, 1508449, 1508450, 1508451, 1508452, 1508453, 1508454, 1508455, 1508477, 1508478, 1508479, 1508480, 1508481, 1508482, 1508483, 1508484, 1508485, 1508486, 1508508, 1508509, 1508510, 1508511, 1508512, 1508513, 1508514, 1508515, 1508516, 1508517, 1508539, 1508540, 1508541, 1508542, 1508543, 1508544, 1508545, 1508546, 1508547, 1508548, 1508570, 1508571, 1508572, 1508573, 1508574, 1508575, 1508576, 1508577, 1508578, 1508579, 1508601, 1508602, 1508603, 1508604, 1508605, 1508606, 1508607, 1508608, 1508609, 1508610, 1508632, 1508633, 1508634, 1508635, 1508636, 1508637, 1508638, 1508639, 1508640, 1508641, 1508663, 1508664, 1508665, 1508666, 1508667, 1508668, 1508669, 1508670, 1508671, 1508672, 1509345, 1509346, 1509347, 1509348, 1509349, 1509350, 1509351, 1509352, 1509353, 1509354, 1509376, 1509377, 1509378, 1509379, 1509380, 1509381, 1509382, 1509383, 1509384, 1509385, 1509407, 1509408, 1509409, 1509410, 1509411, 1509412, 1509413, 1509414, 1509415, 1509416, 1509438, 1509439, 1509440, 1509441, 1509442, 1509443, 1509444, 1509445, 1509446, 1509447, 1509469, 1509470, 1509471, 1509472, 1509473, 1509474, 1509475, 1509476, 1509477, 1509478, 1509500, 1509501, 1509502, 1509503, 1509504, 1509505, 1509506, 1509507, 1509508, 1509509, 1509531, 1509532, 1509533, 1509534, 1509535, 1509536, 1509537, 1509538, 1509539, 1509540, 1509562, 1509563, 1509564, 1509565, 1509566, 1509567, 1509568, 1509569, 1509570, 1509571, 1509593, 1509594, 1509595, 1509596, 1509597, 1509598, 1509599, 1509600, 1509601, 1509602, 1509624, 1509625, 1509626, 1509627, 1509628, 1509629, 1509630, 1509631, 1509632, 1509633, 1510306, 1510307, 1510308, 1510309, 1510310, 1510311, 1510312, 1510313, 1510314, 1510315, 1510337, 1510338, 1510339, 1510340, 1510341, 1510342, 1510343, 1510344, 1510345, 1510346, 1510368, 1510369, 1510370, 1510371, 1510372, 1510373, 1510374, 1510375, 1510376, 1510377, 1510399, 1510400, 1510401, 1510402, 1510403, 1510404, 1510405, 1510406, 1510407, 1510408, 1510430, 1510431, 1510432, 1510433, 1510434, 1510435, 1510436, 1510437, 1510438, 1510439, 1510461, 1510462, 1510463, 1510464, 1510465, 1510466, 1510467, 1510468, 1510469, 1510470, 1510492, 1510493, 1510494, 1510495, 1510496, 1510497, 1510498, 1510499, 1510500, 1510501, 1510523, 1510524, 1510525, 1510526, 1510527, 1510528, 1510529, 1510530, 1510531, 1510532, 1510554, 1510555, 1510556, 1510557, 1510558, 1510559, 1510560, 1510561, 1510562, 1510563, 1510585, 1510586, 1510587, 1510588, 1510589, 1510590, 1510591, 1510592, 1510593, 1510594, 1511267, 1511268, 1511269, 1511270, 1511271, 1511272, 1511273, 1511274, 1511275, 1511276, 1511298, 1511299, 1511300, 1511301, 1511302, 1511303, 1511304, 1511305, 1511306, 1511307, 1511329, 1511330, 1511331, 1511332, 1511333, 1511334, 1511335, 1511336, 1511337, 1511338, 1511360, 1511361, 1511362, 1511363, 1511364, 1511365, 1511366, 1511367, 1511368, 1511369, 1511391, 1511392, 1511393, 1511394, 1511395, 1511396, 1511397, 1511398, 1511399, 1511400, 1511422, 1511423, 1511424, 1511425, 1511426, 1511427, 1511428, 1511429, 1511430, 1511431, 1511453, 1511454, 1511455, 1511456, 1511457, 1511458, 1511459, 1511460, 1511461, 1511462, 1511484, 1511485, 1511486, 1511487, 1511488, 1511489, 1511490, 1511491, 1511492, 1511493, 1511515, 1511516, 1511517, 1511518, 1511519, 1511520, 1511521, 1511522, 1511523, 1511524, 1511546, 1511547, 1511548, 1511549, 1511550, 1511551, 1511552, 1511553, 1511554, 1511555, 1512228, 1512229, 1512230, 1512231, 1512232, 1512233, 1512234, 1512235, 1512236, 1512237, 1512259, 1512260, 1512261, 1512262, 1512263, 1512264, 1512265, 1512266, 1512267, 1512268, 1512290, 1512291, 1512292, 1512293, 1512294, 1512295, 1512296, 1512297, 1512298, 1512299, 1512321, 1512322, 1512323, 1512324, 1512325, 1512326, 1512327, 1512328, 1512329, 1512330, 1512352, 1512353, 1512354, 1512355, 1512356, 1512357, 1512358, 1512359, 1512360, 1512361, 1512383, 1512384, 1512385, 1512386, 1512387, 1512388, 1512389, 1512390, 1512391, 1512392, 1512414, 1512415, 1512416, 1512417, 1512418, 1512419, 1512420, 1512421, 1512422, 1512423, 1512445, 1512446, 1512447, 1512448, 1512449, 1512450, 1512451, 1512452, 1512453, 1512454, 1512476, 1512477, 1512478, 1512479, 1512480, 1512481, 1512482, 1512483, 1512484, 1512485, 1512507, 1512508, 1512509, 1512510, 1512511, 1512512, 1512513, 1512514, 1512515, 1512516, 1513189, 1513190, 1513191, 1513192, 1513193, 1513194, 1513195, 1513196, 1513197, 1513198, 1513220, 1513221, 1513222, 1513223, 1513224, 1513225, 1513226, 1513227, 1513228, 1513229, 1513251, 1513252, 1513253, 1513254, 1513255, 1513256, 1513257, 1513258, 1513259, 1513260, 1513282, 1513283, 1513284, 1513285, 1513286, 1513287, 1513288, 1513289, 1513290, 1513291, 1513313, 1513314, 1513315, 1513316, 1513317, 1513318, 1513319, 1513320, 1513321, 1513322, 1513344, 1513345, 1513346, 1513347, 1513348, 1513349, 1513350, 1513351, 1513352, 1513353, 1513375, 1513376, 1513377, 1513378, 1513379, 1513380, 1513381, 1513382, 1513383, 1513384, 1513406, 1513407, 1513408, 1513409, 1513410, 1513411, 1513412, 1513413, 1513414, 1513415, 1513437, 1513438, 1513439, 1513440, 1513441, 1513442, 1513443, 1513444, 1513445, 1513446, 1513468, 1513469, 1513470, 1513471, 1513472, 1513473, 1513474, 1513475, 1513476, 1513477, 1514150, 1514151, 1514152, 1514153, 1514154, 1514155, 1514156, 1514157, 1514158, 1514159, 1514181, 1514182, 1514183, 1514184, 1514185, 1514186, 1514187, 1514188, 1514189, 1514190, 1514212, 1514213, 1514214, 1514215, 1514216, 1514217, 1514218, 1514219, 1514220, 1514221, 1514243, 1514244, 1514245, 1514246, 1514247, 1514248, 1514249, 1514250, 1514251, 1514252, 1514274, 1514275, 1514276, 1514277, 1514278, 1514279, 1514280, 1514281, 1514282, 1514283, 1514305, 1514306, 1514307, 1514308, 1514309, 1514310, 1514311, 1514312, 1514313, 1514314, 1514336, 1514337, 1514338, 1514339, 1514340, 1514341, 1514342, 1514343, 1514344, 1514345, 1514367, 1514368, 1514369, 1514370, 1514371, 1514372, 1514373, 1514374, 1514375, 1514376, 1514398, 1514399, 1514400, 1514401, 1514402, 1514403, 1514404, 1514405, 1514406, 1514407, 1514429, 1514430, 1514431, 1514432, 1514433, 1514434, 1514435, 1514436, 1514437, 1514438, 1515111, 1515112, 1515113, 1515114, 1515115, 1515116, 1515117, 1515118, 1515119, 1515120, 1515142, 1515143, 1515144, 1515145, 1515146, 1515147, 1515148, 1515149, 1515150, 1515151, 1515173, 1515174, 1515175, 1515176, 1515177, 1515178, 1515179, 1515180, 1515181, 1515182, 1515204, 1515205, 1515206, 1515207, 1515208, 1515209, 1515210, 1515211, 1515212, 1515213, 1515235, 1515236, 1515237, 1515238, 1515239, 1515240, 1515241, 1515242, 1515243, 1515244, 1515266, 1515267, 1515268, 1515269, 1515270, 1515271, 1515272, 1515273, 1515274, 1515275, 1515297, 1515298, 1515299, 1515300, 1515301, 1515302, 1515303, 1515304, 1515305, 1515306, 1515328, 1515329, 1515330, 1515331, 1515332, 1515333, 1515334, 1515335, 1515336, 1515337, 1515359, 1515360, 1515361, 1515362, 1515363, 1515364, 1515365, 1515366, 1515367, 1515368, 1515390, 1515391, 1515392, 1515393, 1515394, 1515395, 1515396, 1515397, 1515398, 1515399, 1516072, 1516073, 1516074, 1516075, 1516076, 1516077, 1516078, 1516079, 1516080, 1516081, 1516103, 1516104, 1516105, 1516106, 1516107, 1516108, 1516109, 1516110, 1516111, 1516112, 1516134, 1516135, 1516136, 1516137, 1516138, 1516139, 1516140, 1516141, 1516142, 1516143, 1516165, 1516166, 1516167, 1516168, 1516169, 1516170, 1516171, 1516172, 1516173, 1516174, 1516196, 1516197, 1516198, 1516199, 1516200, 1516201, 1516202, 1516203, 1516204, 1516205, 1516227, 1516228, 1516229, 1516230, 1516231, 1516232, 1516233, 1516234, 1516235, 1516236, 1516258, 1516259, 1516260, 1516261, 1516262, 1516263, 1516264, 1516265, 1516266, 1516267, 1516289, 1516290, 1516291, 1516292, 1516293, 1516294, 1516295, 1516296, 1516297, 1516298, 1516320, 1516321, 1516322, 1516323, 1516324, 1516325, 1516326, 1516327, 1516328, 1516329, 1516351, 1516352, 1516353, 1516354, 1516355, 1516356, 1516357, 1516358, 1516359, 1516360, 1537214};

        int key = 35;
        //1537214
        System.out.println(search(key, array));
//        for (int _int : array) {
//            System.out.println("key ---- " + _int);
//            System.out.println(search(_int, array));
//        }

    }

    public static boolean search(int key, int[] array) {
        int n = array.length;

        if (key < array[0] || key > array[n-1]) {
            return false;
        }

        int k = (int) Math.floor(Math.log(n) / Math.log(2));
        int i = (int) Math.floor(Math.pow(2, k)) - 1;
        int keyI = array[i];
        int delta;

        if (key > keyI && (int) Math.floor(Math.pow(2, k)) < n) {
            int l = (int) Math.floor(Math.log(n - Math.pow(2, k) + 1) / Math.log(2));
            i = n - (int) Math.floor(Math.pow(2, l));
            System.out.println("i ---" + i); // змещение как у массива

            delta = (int) Math.floor(Math.pow(2, l-1));
            System.out.println("delta ---" + delta);
            keyI = array[i];
            //добавим перерасчет keyI
            return searchRecursive(key, keyI, i, delta, array);
        } else if (key < keyI) {
            delta = (int) Math.floor(Math.pow(2, k-1));
            return searchRecursive(key, keyI, i, delta, array);
        }
        return true;
    }

    public static boolean searchRecursive(int key, int keyI, int i, int delta, int[] array) {
        System.out.println(System.lineSeparator() + "---------");
        System.out.println("key ---- " + key);
        System.out.println("keyI -----" + keyI);
        System.out.println("i ---" + i);
        System.out.println("delta ---" + delta);

        if (delta == 0) {
            counterDelta++;
        }
        if (counterDelta >= array.length) {
            counterDelta = 0;
            return false;
        }

        if (key > keyI) {
            i = i + (delta / 2 + 1);
            delta = delta / 2;
            keyI = array[i];
            return searchRecursive(key, keyI, i, delta, array);
        } else if (key < keyI) {
            i = i - (delta / 2 + 1);
            delta = delta / 2;
            keyI = array[i];
            return searchRecursive(key, keyI, i, delta, array);
        }
        counterDelta = 0;
        return true;
    }
}
